name: FETII_RIDESHARE_ANALYTICS
description: >
  Semantic model for Fetti ride-share analytics enabling natural language queries about trips, riders, venues, and user behavior patterns. This comprehensive dataset covers ride-sharing operations including trip analysis, rider demographics, popular venue destinations, and operational metrics. Perfect for answering questions about transportation patterns, user engagement, and location-based insights.

tables:
  - name: DIM_ADDRESS
    description: >
      Address dimension containing Google-standardized addresses for pickup and dropoff locations. Includes popular venues and landmarks with preserved venue names alongside standardized street addresses.
    synonyms:
      - "addresses"
      - "locations"
      - "places"
      - "venues"
      - "destinations"
    
    base_table:
      database: FETII_AI
      schema: CHATAPP
      table: DIM_ADDRESS
    
    primary_key:
      columns:
        - ADDRESS_ID
    
    dimensions:
      - name: ADDRESS_ID
        synonyms:
          - "address id"
          - "location id"
        description: Unique identifier for each address
        expr: ADDRESS_ID
        data_type: NUMBER(38,0)
        unique: true
      
      - name: ADDRESS_LINE
        synonyms:
          - "address"
          - "street address"
          - "location"
          - "venue"
          - "place name"
        description: Street address or venue name including popular locations and landmarks
        expr: ADDRESS_LINE
        data_type: VARCHAR(16777216)
      
      - name: CITY
        synonyms:
          - "city name"
        description: City name for the address
        expr: CITY
        data_type: VARCHAR(16777216)
      
      - name: STATE
        synonyms:
          - "state name"
        description: State abbreviation
        expr: STATE
        data_type: VARCHAR(16777216)
        sample_values:
          - "TX"
      
      - name: COUNTRY
        synonyms:
          - "country name"
        description: Country name
        expr: COUNTRY
        data_type: VARCHAR(16777216)
        sample_values:
          - "USA"
      
      - name: ZIPCODE
        synonyms:
          - "zip code"
          - "postal code"
        description: ZIP code for the address
        expr: ZIPCODE
        data_type: NUMBER(38,0)

      - name: LATITUDE
        synonyms:
          - "lat"
          - "latitude coordinate"
          - "standardized latitude"
        description: Standardized latitude coordinate for the address location
        expr: LATITUDE
        data_type: NUMBER(38,7)
      
      - name: LONGITUDE
        synonyms:
          - "long"
          - "longitude coordinate"
          - "standardized longitude"
        description: Standardized longitude coordinate for the address location
        expr: LONGITUDE
        data_type: NUMBER(38,7)

  - name: DIM_USER
    description: >
      User dimension containing demographic information about ride-share users, including both riders and bookers. Contains age groups, user behavior classifications (Rider, Booker, or Both), and actual age data for demographic analysis.
    synonyms:
      - "users"
      - "riders" 
      - "customers"
      - "people"
      - "passengers"
    
    base_table:
      database: FETII_AI
      schema: CHATAPP
      table: DIM_USER
    
    primary_key:
      columns:
        - USER_ID
    
    dimensions:
      - name: USER_ID
        synonyms:
          - "user id"
          - "customer id"
          - "rider id"
        description: Unique identifier for each user
        expr: USER_ID
        data_type: NUMBER(38,0)
        unique: true
      
      - name: AGE_GROUP
        synonyms:
          - "age bracket"
          - "age range"
          - "age category"
        description: Age group classification for demographic analysis
        expr: AGE_GROUP
        data_type: VARCHAR(16777216)
        is_enum: true
        sample_values:
          - "18-25"
          - "26-35"
          - "36-45"
          - "46-55"
          - "55+"
          - "Under 18"
          - "Unknown"
      
      - name: USER_TYPE
        synonyms:
          - "user category"
          - "customer type"
          - "user role"
        description: Classification based on user behavior (Rider, Booker, or Both)
        expr: USER_TYPE
        data_type: VARCHAR(16777216)
        is_enum: true
        sample_values:
          - "Rider"
          - "Both" 
          - "Booker"
      
      - name: AGE
        synonyms:
          - "user age"
          - "customer age"
        description: Actual age of the user in years
        expr: AGE
        data_type: NUMBER(38,0)

  - name: FACT_TRIP
    description: >
      Main fact table containing ride-share trip-level data. Includes passenger counts, booking details, precise timing (date, time, day of week, hour), and geographic coordinates for pickup/dropoff locations. Contains detailed operational metrics for each trip.
    synonyms:
      - "trips"
      - "rides"
      - "journeys"
      - "bookings"
    
    base_table:
      database: FETII_AI
      schema: CHATAPP
      table: FACT_TRIP
    
    primary_key:
      columns:
        - TRIP_ID
    
    dimensions:
      - name: TRIP_ID
        synonyms:
          - "trip id"
          - "ride id"
        description: Unique identifier for each trip
        expr: TRIP_ID
        data_type: NUMBER(38,0)
        unique: true
      
      - name: BOOKING_USER_ID
        synonyms:
          - "booker id"
          - "booking user"
        description: ID of the user who booked the trip
        expr: BOOKING_USER_ID
        data_type: NUMBER(38,0)
      
      - name: PICKUP_ADDRESS_ID
        synonyms:
          - "pickup location id"
          - "start address id"
        description: Address ID for pickup location
        expr: PICKUP_ADDRESS_ID
        data_type: NUMBER(38,0)
      
      - name: DROPOFF_ADDRESS_ID
        synonyms:
          - "dropoff location id"
          - "destination address id"
          - "end address id"
        description: Address ID for dropoff location  
        expr: DROPOFF_ADDRESS_ID
        data_type: NUMBER(38,0)
      
      - name: DAY_OF_WEEK
        synonyms:
          - "day"
          - "weekday"
        description: Day of the week when trip occurred
        expr: DAY_OF_WEEK
        data_type: VARCHAR(16777216)
        is_enum: true
        sample_values:
          - "Monday"
          - "Tuesday"
          - "Wednesday"
          - "Thursday"
          - "Friday"
          - "Saturday"
          - "Sunday"
      
      - name: HOUR_OF_DAY
        synonyms:
          - "hour"
          - "time of day"
        description: Hour of day (0-23) when trip started
        expr: HOUR_OF_DAY
        data_type: NUMBER(38,0)
      
      - name: MONTH
        synonyms:
          - "month number"
        description: Month number (1-12) when trip occurred
        expr: MONTH
        data_type: NUMBER(38,0)
      
      - name: YEAR
        synonyms:
          - "year number"
        description: Year when trip occurred
        expr: YEAR
        data_type: NUMBER(38,0)
      
      - name: PICKUP_LATITUDE
        synonyms:
          - "pickup lat"
          - "start latitude"
          - "original pickup latitude"
        description: Precise latitude coordinate where trip pickup occurred
        expr: PICKUP_LATITUDE
        data_type: NUMBER(38,7)
      
      - name: PICKUP_LONGITUDE
        synonyms:
          - "pickup long"
          - "start longitude"
          - "original pickup longitude"
        description: Precise longitude coordinate where trip pickup occurred
        expr: PICKUP_LONGITUDE
        data_type: NUMBER(38,7)
      
      - name: DROPOFF_LATITUDE
        synonyms:
          - "dropoff lat"
          - "end latitude"
          - "original dropoff latitude"
        description: Precise latitude coordinate where trip dropoff occurred
        expr: DROPOFF_LATITUDE
        data_type: NUMBER(38,7)
      
      - name: DROPOFF_LONGITUDE
        synonyms:
          - "dropoff long"
          - "end longitude"
          - "original dropoff longitude"
        description: Precise longitude coordinate where trip dropoff occurred
        expr: DROPOFF_LONGITUDE
        data_type: NUMBER(38,7)
    
    time_dimensions:
      - name: TRIP_DATE
        synonyms:
          - "trip date"
          - "ride date"
          - "date"
        description: Date when the trip occurred
        expr: TRIP_DATE
        data_type: DATE
        unique: false
      
      - name: TRIP_TIME
        synonyms:
          - "trip time"
          - "ride time"
          - "start time"
        description: Time when the trip started
        expr: TRIP_TIME
        data_type: TIME(9)
        unique: false
    
    facts:
      - name: TOTAL_PASSENGERS
        synonyms:
          - "passengers"
          - "total passengers"
          - "passenger count"
          - "booked passengers"
        description: Total number of passengers booked for the trip
        expr: TOTAL_PASSENGERS
        data_type: NUMBER(38,0)
      
      - name: ACTUAL_RIDERS_COUNT
        synonyms:
          - "actual riders"
          - "tracked riders"
          - "confirmed riders"
        description: Number of riders actually tracked in the system
        expr: ACTUAL_RIDERS_COUNT
        data_type: NUMBER(38,0)
    
    metrics:
      - name: TOTAL_TRIPS
        synonyms:
          - "trip count"
          - "number of trips"
          - "ride count"
        description: Total number of trips
        expr: COUNT(TRIP_ID)
      
      - name: AVG_PASSENGERS_PER_TRIP
        synonyms:
          - "average passengers"
          - "mean passengers per trip"
        description: Average number of passengers per trip
        expr: AVG(TOTAL_PASSENGERS)
      
      - name: AVG_ACTUAL_RIDERS_PER_TRIP
        synonyms:
          - "average actual riders"
          - "mean tracked riders"
        description: Average number of actual riders per trip
        expr: AVG(ACTUAL_RIDERS_COUNT)
    
    filters:
      - name: WEEKEND_TRIPS
        synonyms:
          - "weekend"
          - "weekend rides"
        description: Trips that occurred on weekends
        expr: DAY_OF_WEEK IN ('Saturday', 'Sunday')
      
      - name: WEEKDAY_TRIPS
        synonyms:
          - "weekday"
          - "business days"
        description: Trips that occurred on weekdays
        expr: DAY_OF_WEEK NOT IN ('Saturday', 'Sunday')

  - name: FACT_TRIP_RIDERS
    description: >
      Bridge table capturing the many-to-many relationship between trips and riders in the ride-share system. Links individual riders to shared trips, enabling detailed analysis of rider participation patterns and group ride behavior.
    synonyms:
      - "trip riders"
      - "rider trips"
      - "trip participants"
      - "passengers per trip"
    
    base_table:
      database: FETII_AI
      schema: CHATAPP
      table: FACT_TRIP_RIDERS
    
    primary_key:
      columns:
        - TRIP_ID
        - RIDER_USER_ID
    
    dimensions:
      - name: TRIP_ID
        synonyms:
          - "trip id"
          - "ride id"
        description: Trip identifier linking to FACT_TRIP
        expr: TRIP_ID
        data_type: NUMBER(38,0)
      
      - name: RIDER_USER_ID
        synonyms:
          - "rider id"
          - "participant id"
        description: User ID of the trip participant
        expr: RIDER_USER_ID
        data_type: NUMBER(38,0)
    
    metrics:
      - name: TOTAL_TRIP_PARTICIPATIONS
        synonyms:
          - "total participations"
          - "rider trip count"
        description: Total number of trip participations
        expr: COUNT(*)
      
      - name: UNIQUE_RIDERS
        synonyms:
          - "distinct riders"
          - "number of unique riders"
        description: Count of unique riders
        expr: COUNT(DISTINCT RIDER_USER_ID)

relationships:
  - name: TRIP_TO_PICKUP_ADDRESS
    left_table: FACT_TRIP
    right_table: DIM_ADDRESS
    relationship_columns:
      - left_column: PICKUP_ADDRESS_ID
        right_column: ADDRESS_ID
    join_type: left_outer
    relationship_type: many_to_one

  - name: TRIP_TO_DROPOFF_ADDRESS
    left_table: FACT_TRIP
    right_table: DIM_ADDRESS
    relationship_columns:
      - left_column: DROPOFF_ADDRESS_ID
        right_column: ADDRESS_ID
    join_type: left_outer
    relationship_type: many_to_one

  - name: TRIP_TO_BOOKING_USER
    left_table: FACT_TRIP
    right_table: DIM_USER
    relationship_columns:
      - left_column: BOOKING_USER_ID
        right_column: USER_ID
    join_type: left_outer
    relationship_type: many_to_one

  - name: TRIP_RIDERS_TO_TRIP
    left_table: FACT_TRIP_RIDERS
    right_table: FACT_TRIP
    relationship_columns:
      - left_column: TRIP_ID
        right_column: TRIP_ID
    join_type: inner
    relationship_type: many_to_one

  - name: TRIP_RIDERS_TO_USER
    left_table: FACT_TRIP_RIDERS
    right_table: DIM_USER
    relationship_columns:
      - left_column: RIDER_USER_ID
        right_column: USER_ID
    join_type: left_outer
    relationship_type: many_to_one

verified_queries:
  - name: "Total trips by day of week"
    question: "How many trips happened on each day of the week?"
    verified_by: "Data Analyst"
    use_as_onboarding_question: true
    sql: |
      SELECT 
        DAY_OF_WEEK,
        COUNT(TRIP_ID) as total_trips
      FROM FACT_TRIP
      GROUP BY DAY_OF_WEEK
      ORDER BY total_trips DESC

  - name: "Average passengers by age group"
    question: "What is the average number of passengers per trip by rider age group?"
    verified_by: "Data Analyst"
    use_as_onboarding_question: true
    sql: |
      SELECT 
        u.AGE_GROUP,
        AVG(f.TOTAL_PASSENGERS) as avg_passengers
      FROM FACT_TRIP f
      JOIN FACT_TRIP_RIDERS tr ON tr.TRIP_ID = f.TRIP_ID
      JOIN DIM_USER u ON tr.RIDER_USER_ID = u.USER_ID
      GROUP BY u.AGE_GROUP
      ORDER BY avg_passengers DESC

  - name: "Most popular pickup locations"
    question: "What are the top 10 most popular pickup locations?"
    verified_by: "Data Analyst"
    use_as_onboarding_question: true
    sql: |
      SELECT 
        a.ADDRESS_LINE,
        a.CITY,
        a.ZIPCODE,
        COUNT(f.TRIP_ID) as trip_count
      FROM FACT_TRIP f
      JOIN DIM_ADDRESS a ON f.PICKUP_ADDRESS_ID = a.ADDRESS_ID
      GROUP BY a.ADDRESS_LINE, a.CITY, a.ZIPCODE
      ORDER BY trip_count DESC
      LIMIT 10

  - name: "Peak hours analysis"
    question: "Which hours of the day have the most trips?"
    verified_by: "Data Analyst"
    use_as_onboarding_question: true
    sql: |
      SELECT 
        HOUR_OF_DAY,
        COUNT(TRIP_ID) as trip_count
      FROM FACT_TRIP
      GROUP BY HOUR_OF_DAY
      ORDER BY trip_count DESC

  - name: "Rider engagement by user type"
    question: "How many trips do different user types take on average?"
    verified_by: "Data Analyst"
    use_as_onboarding_question: false
    sql: |
      SELECT 
        u.USER_TYPE,
        COUNT(tr.TRIP_ID) as total_trips,
        COUNT(DISTINCT tr.RIDER_USER_ID) as unique_riders,
        ROUND(COUNT(tr.TRIP_ID) / COUNT(DISTINCT tr.RIDER_USER_ID), 2) as avg_trips_per_rider
      FROM FACT_TRIP_RIDERS tr
      JOIN DIM_USER u ON tr.RIDER_USER_ID = u.USER_ID
      GROUP BY u.USER_TYPE
      ORDER BY avg_trips_per_rider DESC
